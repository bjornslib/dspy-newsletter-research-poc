# v3.9 Agent Quick Reference - CSV Transformation

## Purpose

**MANDATORY READ BEFORE ANY CSV TRANSFORMATION**

This document provides the essential v3.9 schema knowledge for transform-agent and qa-agent:
- JSONB field structure (types, required/optional)
- Critical decision rules (NULL-First, verification_status)
- 4 perfect transformation examples
- Anti-hallucination checklist

**Time to Read**: 5 minutes | **Line Count**: ~320 lines | **Last Updated**: 2025-11-21

---

## ‚úÖ DATABASE SCHEMA STATUS (CONFIRMED 2025-11-21)

**All three verification text fields exist in database**:

| JSON Field | Database Column | Type | Status |
|------------|----------------|------|--------|
| `verification_requirements` | `verification_requirements` | TEXT | ‚úÖ EXISTS - Import script UPDATED |
| `verification_process` | `verification_process` | TEXT | ‚úÖ EXISTS - Import script UPDATED |
| `notes` | `contact_notes` | TEXT | ‚úÖ EXISTS - Import script UPDATED |

**Import Behavior** (as of 2025-11-21):
- ‚úÖ All three fields properly extracted from JSON
- ‚úÖ All three fields stored in database
- ‚úÖ Both INSERT and UPDATE queries include all fields

**Note**: JSON field `notes` maps to database column `contact_notes`.

---

## 1. v3.9 JSONB Field Structure

### Complete Field Reference

| Field | Type | Required | Purpose | NULL When |
|-------|------|----------|---------|-----------|
| `name` | str | NO | Full contact name | No name in CSV |
| `email` | str | NO | Email address | No email found |
| `title` | str | NO | Job title | Can't determine title |
| `department` | str | NO | Department name | No department info |
| `phone` | str | NO | Phone number | No phone in CSV |
| `website` | str | NO | Website URL | No website mentioned |
| `location_name` | str | NO | Campus/location | Single campus or unclear |
| `moi_methods` | List[str] | NO | Contact methods | Use `["email"]` as default when available |
| `online_verification` | bool | NO | Online portal exists | Usually `false` and only true when URl explicitly provided OR online verification mentioned in notes/ comments |
| `program_scope` | List[str] | NO | Programs handled | null unless specified (see examples) |
| `is_primary` | bool | NO | Primary contact | First contact = true, additional contacts = false |
| **`routing_metadata`** (in each contact) | object | **YES** | **Verification data per contact** | **REQUIRED in EACH contact object** - see below |
| `confidence_score` | float | NO | Quality score 0-1 | Based on data clarity |
| `verification_requirements` | str | NO | Required documents/credentials | **WHAT is needed** - Documents, credentials, forms required for verification. Copy verbatim. Examples: "LOA, ECF, full name of student", "Official transcript, Certificate of Enrollment" |
| `verification_process` | str | NO | Process instructions | **HOW verification works** - Step-by-step procedures, submission methods, timelines, policies. Copy verbatim (including full letters). Examples: Letter format requirements, contact procedures, office hours |
| `notes` | str | NO | Miscellaneous information | **CATCH-ALL for everything else** - Any information not covered by verification_requirements or verification_process. Examples: banking details, fax numbers, operational status ("already winding down"), special circumstances, limitations |

### Field Content Guidelines (CRITICAL)

**MANDATORY RULE**: Copy content VERBATIM - NEVER summarize or condense.

| Field | Content Type | Transformation Rule |
|-------|--------------|---------------------|
| `verification_requirements` | **WHAT documents/credentials** | Extract any text describing required documents, credentials, forms. Copy VERBATIM. Look for: LOA, transcripts, certificates, consent forms, student details requirements. |
| `verification_process` | **HOW verification works** | Extract procedural instructions, policies, timelines, submission methods. Copy VERBATIM including full letters/emails. Look for: step-by-step processes, letter format requirements, contact procedures, office hours. |
| `notes` | **Everything else (catch-all)** | Any information NOT about verification requirements or process. Copy VERBATIM. Examples: banking details, fax numbers, operational status ("already winding down"), special circumstances, alternative contact methods beyond email/phone. |

**Example - Correct Verbatim Copy**:

**Source Data** (Row 492 ICPAS):
```
Requirements field: "LOA, ECF, full name of student"

Process instructions field: "Dear Concern,

Greetings!

This is to inform you in response to your e-mail that a sealed official letter in letter head of your organization along with hard copy (xerox copy) of academic credentials (i.e. transcripts, certificates etc.) of the concerned student(s) is to be forwarded to the Controller of Examinations...

[286-word formal letter continues with full verification process details]

Thank you
(Mehdi Hasan)
Officer"
```

**Correct JSON Output**:
```json
{
  "verification_requirements": "LOA, ECF, full name of student",
  "verification_process": "Dear Concern,\n\nGreetings!\n\nThis is to inform you in response to your e-mail that a sealed official letter in letter head of your organization along with hard copy (xerox copy) of academic credentials (i.e. transcripts, certificates etc.) of the concerned student(s) is to be forwarded to the Controller of Examinations...\n\n[FULL 286-WORD LETTER COPIED VERBATIM]\n\nThank you\n(Mehdi Hasan)\nOfficer",
  "notes": null
}
```

**‚ùå VIOLATION - Summarized (NEVER DO THIS)**:
```json
{
  "notes": "Requirements: LOA, ECF, full name. VERIFICATION PROCESS: Sealed official letter on letterhead with hard copy of academic credentials required..."
}
```

**Why This Matters**: Summarization loses critical details (contact names, specific procedures, exact wording). User needs complete information for compliance and verification processes.

### RoutingMetadata (REQUIRED - MUST be nested INSIDE EACH contact object)

**üö® CRITICAL PLACEMENT RULE**: This object MUST appear INSIDE each contact object within the `verification_point_of_contacts` array. EVERY contact MUST have its own routing_metadata.

**CORRECT Structure** (routing_metadata INSIDE each contact):
```json
{
  "verification_point_of_contacts": [
    {
      "email": "contact1@example.edu",
      "routing_metadata": {  // ‚Üê INSIDE EACH CONTACT OBJECT
        "verification_status": "verified",  // REQUIRED: "verified" or "pending"
        "last_verified": null,              // Optional: ISO 8601 timestamp
        "response_count": 0,                // Optional: integer
        "sources": ["RMI"],                 // REQUIRED: List[str] - data provenance
        "citations": []                     // REQUIRED: List[CitationMetadata] - web evidence
      }
    }
  ]
}
```

**Field Details**:
```json
{
  "verification_status": "verified",  // REQUIRED: "verified" or "pending"
  "last_verified": null,              // Optional: ISO 8601 timestamp
  "response_count": 0,                // Optional: integer
  "sources": ["RMI"],                 // REQUIRED: List[str] - data provenance (WHO created)
  "citations": []                     // REQUIRED: List[CitationMetadata] - web evidence (WHERE found)
}
```

### Sources Field - Data Provenance (WHO created this contact)

**Valid Values**:
- `"RMI"` - Customer-provided data from CSV
- `"Agencheck"` - Automated discovery found contact using Perplexity, Eddy Deep Research

**For CSV Transformation**: Always `["RMI"]` (or whichever customer name as data origin provided by user)

### Citations Field - Web Evidence (WHERE information was found)

**Structure** (when Perplexity enhances data):
```json
[
  {
    "url": "https://university.edu/contact",
    "title": "Contact Information - University Website",
    "retrieved_at": "2025-11-21T10:30:00Z"  // REQUIRED - ISO 8601
  }
]
```

**For Pure CSV Transformation**: Always `[]` (empty - no web research)

---

## 2. Critical Decision Rules

### Rule 0: NEVER SUMMARIZE CSV Content (CRITICAL)

**GOLDEN RULE**: Copy CSV content VERBATIM - especially REQUIREMENTS and SPECIAL INSTRUCTION columns.

```
‚ùå NEVER SUMMARIZE
‚ùå NEVER CONDENSE
‚ùå NEVER PARAPHRASE
‚úÖ ALWAYS COPY VERBATIM
‚úÖ PRESERVE FULL LETTERS/EMAILS
‚úÖ MAINTAIN EXACT WORDING
```

**Why**: Verification processes require EXACT information - summarization loses critical details:
- Contact names and signatures
- Specific document requirements
- Precise procedural steps
- Legal/compliance language

**Example Violation** (Row 492 ICPAS):
- ‚ùå Summarized: "Sealed official letter on letterhead with hard copy required..."
- ‚úÖ Verbatim: Full 286-word formal letter with contact name (Mehdi Hasan), title (Officer), department (Office of the Controller of Examinations), complete process description

### Rule 1: NULL-First Principle (MANDATORY)

**Golden Rule**: NULL is better than invented data.

```
WHEN UNCERTAIN ‚Üí USE null
WHEN MISSING ‚Üí USE null
WHEN AMBIGUOUS ‚Üí USE null
NEVER INVENT ‚Üí USE null
```

**Forbidden Hallucinations** (NEVER use unless explicitly in CSV):
- ‚ùå "Contact Person"
- ‚ùå "Main Campus"
- ‚ùå "Registrar's Office"
- ‚ùå "Verification Services"
- ‚ùå "Main Office" (unless explicitly stated)
- ‚ùå "University Registrar" (unless explicitly stated)

### Rule 2: verification_status Decision Logic

**CRITICAL**: Status determined by DATA ORIGIN (sources), NOT research enhancement.

```python
# Decision Tree
if "RMI" or "Customer Name" in sources or "manual_entry" in sources:
    return "verified"  # Customer data = trusted

elif sources and sources[0] in ["Agencheck", "eddy_validate", "eddy_deep_research", "perplexity"]:
    return "pending"   # Research-only = needs confirmation

else:
    return "pending"   # Conservative default
```

**Examples**:
| sources | verification_status | Why |
|---------|---------------------|-----|
| `["RMI"] or "["{Customer_Name}"]` | "verified" | Customer-provided CSV data |
| `["RMI", "Agencheck"]` | "verified" | Origin is RMI (Perplexity enhanced) |
| `["Agencheck"]` | "pending" | Research-only, no customer data |
| `[]` | "pending" | Unknown origin |

**For CSV Transformation**: Since origin is RMI/ Customer CSV ‚Üí Always `"verified"`

### Rule 3: The 3-Question Framework (Anti-Hallucination)

**BEFORE populating name/title/department, ask**:

1. **Is this a DEPARTMENT?**
   ‚Üí `department: "value", name: null, title: null`

2. **Is this a NAME + TITLE?**
   ‚Üí `name: "John Smith", title: "Registrar", department: null`

3. **Is this ONLY a NAME?**
   ‚Üí `name: "John Smith", title: null, department: null`

4. **NOTHING clear?**
   ‚Üí `name: null, title: null, department: null`

**Example from CSV**:
- "Registrar's Office" ‚Üí `department: "Registrar's Office", name: null, title: null`
- "John Smith, Registrar" ‚Üí `name: "John Smith", title: "Registrar", department: null`
- "admissions@" ‚Üí Extract from email ‚Üí `department: "Admissions", name: null, title: null`

---

## 3. Perfect Transformation Examples

**üö® CRITICAL**: All 12 examples below demonstrate the MANDATORY pattern: `routing_metadata` appears INSIDE each contact object in the `verification_point_of_contacts` array.

<wrong>
```json
{
  "institution_name": "University Name",
  "routing_metadata": {"sources": ["RMI"]},
  "verification_point_of_contacts": [{"email": "contact@edu"}]
}
```
</wrong>

<correct>
```json
{
  "institution_name": "University Name",
  "verification_point_of_contacts": [
    {
      "email": "contact@edu",
      "routing_metadata": {"sources": ["RMI"]}
    }
  ]
}
```
</correct>

---

### Example 1: Multiple Contacts (Pattern C - Delimiter Parsing)

**Source Data**:
```
Institution: National University of Singapore
Country: Singapore
Contact emails: admissions@nus.edu.sg; records@nus.edu.sg or transcript@nus.edu.sg
Requirements: Official transcript, Certificate of Enrollment
Process instructions: (empty)
```

**Perfect Output** (3 contacts from delimiter precedence, verbatim requirements):
```json
{
  "institution_name": "National University of Singapore",
  "country": "Singapore",
  "customer_id": 34,
  "confidence_score": 0.95,
  "pattern_detection": {
    "detected_pattern": "Pattern C - Multiple email delimiters",
    "multi_campus": false,
    "program_routing": false
  },
  "import_metadata": {
    "source_csv_row": 1,
    "transformation_version": "3.9",
    "data_structure_pattern": "Pattern C",
    "extraction_reasoning": "Detected Pattern C with semicolon and 'or' delimiters. Created 3 POCs based on delimiter precedence (semicolon > or). Departments extracted from email prefixes."
  },
  "verification_requirements": "Official transcript, Certificate of Enrollment",
  "verification_process": null,
  "notes": null,
  "verification_point_of_contacts": [
    {
      "name": null,
      "department": "Admissions",
      "email": "admissions@nus.edu.sg",
      "title": "Admissions Officer",
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      }
    },
    {
      "name": null,
      "department": "Records Office",
      "email": "records@nus.edu.sg",
      "title": "Records Officer",
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      }
    },
    {
      "name": null,
      "department": "Transcript Services",
      "email": "transcript@nus.edu.sg",
      "title": "Transcript Officer",
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      }
    }
  ]
}
```

**Key Features**:
- ‚úÖ Delimiter precedence: semicolon > "or" (2 contacts from "or" clause)
- ‚úÖ Email-based department inference: admissions@, records@, transcript@
- ‚úÖ NULL name (no person name in CSV)
- ‚úÖ Title inferred from department
- ‚úÖ is_primary: First = true, rest = false

---

### Example 2: Multi-Campus (Pattern B - Location Assignment)

**CSV Input**:
```
INSTITUTION NAME: Philippine Normal University
CONTACT DETAILS: manila.registrar@pnu.edu.ph - Manila Campus
visayas.registrar@pnu.edu.ph - Visayas Campus
```

**Perfect Output** (2 campuses with location_name):
```json
{
  "institution_name": "Philippine Normal University",
  "country": "Philippines",
  "verification_point_of_contacts": [
    {
      "name": null,
      "department": "Manila Campus Registrar",
      "email": "manila.registrar@pnu.edu.ph",
      "title": "Campus Registrar",
      "location_name": "Manila Campus",
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      }
    },
    {
      "name": null,
      "department": "Visayas Campus Registrar",
      "email": "visayas.registrar@pnu.edu.ph",
      "title": "Campus Registrar",
      "location_name": "Visayas Campus",
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      }
    }
  ]
}
```

**Key Features**:
- ‚úÖ Pattern B detection: "email - Campus Name"
- ‚úÖ location_name assigned to each contact
- ‚úÖ Department inference: Campus + "Registrar"
- ‚úÖ Geographic routing enabled

---

### Example 3: Vendor MOI (Pattern A - Labeled Fields)

**CSV Input**:
```
INSTITUTION NAME: University of Toronto
MOI: Online, Email, Phone
CONTACT DETAILS: NAME: Sarah Chen, verification@utoronto.ca
SPECIAL INSTRUCTION: Use online portal: https://verify.utoronto.ca
```

**Perfect Output** (online portal priority):
```json
{
  "institution_name": "University of Toronto",
  "country": "Canada",
  "verification_point_of_contacts": [
    {
      "name": "Sarah Chen",
      "department": null,
      "email": "verification@utoronto.ca",
      "title": null,
      "website": "https://verify.utoronto.ca",
      "online_verification": true,
      "moi_methods": ["online", "email", "phone"],
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Use online portal: https://verify.utoronto.ca"
    }
  ]
}
```

**Key Features**:
- ‚úÖ Pattern A: NAME: label detected
- ‚úÖ moi_methods ordered by preference (online first)
- ‚úÖ online_verification: true (portal available)
- ‚úÖ notes: Special instruction preserved

---

### Example 4: Multi-Campus with 5 Locations (Complex Pattern B)

**CSV Input** (Row 26 - requires --format json):
```
INSTITUTION NAME: Aklan State University
COUNTRY: Philippines
CONTACT DETAILS: asu.registrar@yahoo.com - Banga Campus

kalibo.registrar@asu.edu.ph - Kalibo Campus

registrar.ibajay@asu.edu.ph - Ibajay Campus

registrar.cfms@asu.edu.ph - New Washington

asumakato.registrar@gmail.com - Makato
REQUIREMENTS: 1. LOA, 2. ECF
```

**Perfect Output** (5 campuses, mixed domains):
```json
{
  "institution_name": "Aklan State University",
  "country": "Philippines",
  "verification_point_of_contacts": [
    {
      "department": "Banga Campus Registrar",
      "email": "asu.registrar@yahoo.com",
      "title": "Campus Registrar",
      "location_name": "Banga Campus",
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: 1. LOA, 2. ECF"
    },
    {
      "department": "Kalibo Campus Registrar",
      "email": "kalibo.registrar@asu.edu.ph",
      "location_name": "Kalibo Campus",
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: 1. LOA, 2. ECF"
    },
    {
      "department": "Ibajay Campus Registrar",
      "email": "registrar.ibajay@asu.edu.ph",
      "location_name": "Ibajay Campus",
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: 1. LOA, 2. ECF"
    },
    {
      "department": "New Washington Campus Registrar",
      "email": "registrar.cfms@asu.edu.ph",
      "location_name": "New Washington",
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: 1. LOA, 2. ECF"
    },
    {
      "department": "Makato Campus Registrar",
      "email": "asumakato.registrar@gmail.com",
      "location_name": "Makato",
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: 1. LOA, 2. ECF"
    }
  ]
}
```

**Key Features**:
- ‚úÖ 5 campuses extracted (requires --format json to avoid truncation)
- ‚úÖ Mixed domains handled: yahoo.com, gmail.com, asu.edu.ph
- ‚úÖ Notes shared across all contacts
- ‚úÖ Geographic routing via location_name

---

### Example 5: Person Name + Title + Phone (Pattern A - Labeled)

**CSV Input** (Row 25):
```
INSTITUTION NAME: Airlink International Aviation School
COUNTRY: Philippines
POC DETAILS: +63 2 8514428
Annalisa Villacora
Registrar staff
CONTACT DETAILS: ALIAC Registrar <registrar@aliac.edu.ph>
REQUIREMENTS: 1. LOA, 2. ECF, 3. Education Documents, 4. Passport
```

**Perfect Output** (person with name, title, phone):
```json
{
  "institution_name": "Airlink International Aviation School",
  "country": "Philippines",
  "verification_point_of_contacts": [
    {
      "name": "Annalisa Villacora",
      "department": null,
      "email": "registrar@aliac.edu.ph",
      "phone": "+63 2 8514428",
      "title": "Registrar staff",
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: 1. LOA, 2. ECF, 3. Education Documents, 4. Passport"
    }
  ]
}
```

**Key Features**:
- ‚úÖ Person name extracted from POC DETAILS
- ‚úÖ Title: "Registrar staff" (as stated)
- ‚úÖ Phone from POC DETAILS
- ‚úÖ Email from CONTACT DETAILS (stripped "ALIAC Registrar <...>" format)
- ‚úÖ NULL department (person-focused, not department)
- ‚úÖ Comprehensive notes from REQUIREMENTS

---

### Example 6: Vendor MOI + Multiple Contacts (Pattern C)

**CSV Input** (Row 37):
```
INSTITUTION NAME: American International University - Bangladesh
COUNTRY: Bangladesh
POC DETAILS: Vendor;via Site Visit;
CONTACT DETAILS: AIUB Information <info@aiub.edu>; asif@aiub.edu; <registrar@aiub.edu>; <piuscosta@aiub.edu>; <records@aiub.edu>.
REQUIREMENTS: LOA, ECF
```

**Perfect Output** (vendor MOI with 5 contacts):
```json
{
  "institution_name": "American International University - Bangladesh",
  "country": "Bangladesh",
  "verification_point_of_contacts": [
    {
      "name": null,
      "department": "Information Office",
      "email": "info@aiub.edu",
      "moi_methods": ["vendor", "email"],
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. Vendor: via Site Visit"
    },
    {
      "name": "Asif",
      "department": null,
      "email": "asif@aiub.edu",
      "moi_methods": ["vendor", "email"],
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. Vendor: via Site Visit"
    },
    {
      "name": null,
      "department": "Registrar",
      "email": "registrar@aiub.edu",
      "moi_methods": ["vendor", "email"],
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. Vendor: via Site Visit"
    },
    {
      "name": "Pius Costa",
      "department": null,
      "email": "piuscosta@aiub.edu",
      "moi_methods": ["vendor", "email"],
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. Vendor: via Site Visit"
    },
    {
      "name": null,
      "department": "Records Office",
      "email": "records@aiub.edu",
      "moi_methods": ["vendor", "email"],
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. Vendor: via Site Visit"
    }
  ]
}
```

**Key Features**:
- ‚úÖ moi_methods: ["vendor", "email"] - vendor FIRST (preferred method from POC DETAILS)
- ‚úÖ 5 contacts extracted from semicolon-delimited list
- ‚úÖ Name inference: "asif@" ‚Üí "Asif", "piuscosta@" ‚Üí "Pius Costa"
- ‚úÖ Department inference: "info@" ‚Üí "Information Office", "records@" ‚Üí "Records Office"
- ‚úÖ notes: Combined REQUIREMENTS + vendor method
- ‚úÖ Vendor context preserved: "Vendor: via Site Visit"

---

### Example 7: Complex Notes + Routing Instructions (Pattern A)

**CSV Input** (Row 58):
```
INSTITUTION NAME: Apollos University
COUNTRY: United States
POC DETAILS: Dr. Paul Eidson
CEO
CONTACT DETAILS: Please be aware and take note that all requests for information concerning students or graduates must go to info@apollos.edu. Otherwise, it slows the process down considerably.

Registrar <registrar@apollos.edu>

POC for Asian students:
dreidson@apollos.edu

REQUIREMENTS: LOA, ECF, Degree Certificate
SPECIAL INSTRUCTION: Not Applicable
```

**Perfect Output** (routing instructions preserved):
```json
{
  "institution_name": "Apollos University",
  "country": "United States",
  "verification_point_of_contacts": [
    {
      "name": "Dr. Paul Eidson",
      "department": null,
      "email": "dreidson@apollos.edu",
      "title": "CEO",
      "program_scope": ["Asian students"],
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF, Degree Certificate. ROUTING: All general requests must go to info@apollos.edu (speeds up process). POC for Asian students: dreidson@apollos.edu"
    },
    {
      "name": null,
      "department": "Information Office",
      "email": "info@apollos.edu",
      "title": null,
      "program_scope": null,
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF, Degree Certificate. ROUTING: Primary contact for all general student/graduate information requests"
    },
    {
      "name": null,
      "department": "Registrar",
      "email": "registrar@apollos.edu",
      "title": null,
      "program_scope": null,
      "is_primary": false,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF, Degree Certificate"
    }
  ]
}
```

**Key Features**:
- ‚úÖ Person-focused contact (CEO) with program_scope routing
- ‚úÖ Complex ROUTING instructions preserved in notes
- ‚úÖ Multiple contacts with clear priority (is_primary)
- ‚úÖ General info@ contact as secondary (speeds up process)
- ‚úÖ department inferred from email pattern (info@ ‚Üí "Information Office")

---

### Example 8: Extensive Fee/Process Notes (Pattern A)

**CSV Input** (Row 65):
```
INSTITUTION NAME: Asia e University / Asia eUniversity
COUNTRY: Malaysia
POC DETAILS: The fee structure will be as follows:
‚Ä¢         Degree Verification for International Student: USD10
‚Ä¢         Degree Verification for Local Student: RM10
‚Ä¢         Academic Transcript Verification for International Student: USD10
‚Ä¢         Academic Transcript Verification for Local Student: RM10

CONTACT DETAILS: speed@aeu.edu.my
+603 5022 3459

Once payment is confirmed by the Finance Unit, our team will verify the information and provide results within 2- 3 working days.
Kindly refer to the attached procedure and flowchart for a visual representation of the process.
If you have any questions or need clarification, contact us at speed@aeu.edu.my or +603 50223459.

REQUIREMENTS: 1. LOA, 2. ECF
```

**Perfect Output** (extensive operational notes):
```json
{
  "institution_name": "Asia e University",
  "country": "Malaysia",
  "verification_point_of_contacts": [
    {
      "name": null,
      "department": "Student Placement, Employability, and Development (SPEED)",
      "email": "speed@aeu.edu.my",
      "phone": "+603 5022 3459",
      "title": null,
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. FEE STRUCTURE: Degree Verification (International: USD10, Local: RM10), Academic Transcript Verification (International: USD10, Local: RM10). TURNAROUND: 2-3 working days after Finance Unit confirms payment. Contact for clarification: speed@aeu.edu.my or +603 5022 3459."
    }
  ]
}
```

**Key Features**:
- ‚úÖ Department inferred from email (speed@ ‚Üí "SPEED")
- ‚úÖ Extensive fee structure preserved in notes (USD10/RM10 by type)
- ‚úÖ Turnaround time documented (2-3 working days)
- ‚úÖ Payment process noted (Finance Unit confirmation)
- ‚úÖ Comprehensive operational details for customer reference

---

### Example 9: Verification Clarifications with Person (Pattern A)

**CSV Input** (Row 68):
```
INSTITUTION NAME: Asia Pacific University of Technology & Innovation
COUNTRY: Malaysia
POC DETAILS: Salbiah Abu
Programme Administrator
CONTACT DETAILS: APU Graduate Verification Team <verify@staffemail.apu.edu.my>
REQUIREMENTS: Student Registration Number / Certificate
SPECIAL INSTRUCTION: As of 14 Aug 2024 Confirmed by the verifier:

Is the Completion date same as the Award Date? : Yes, same.
2. Does the status "Completed" can also be considered that the qualification has been AWARDED ? : Yes.
```

**Perfect Output** (person + extensive clarifications):
```json
{
  "institution_name": "Asia Pacific University of Technology & Innovation",
  "country": "Malaysia",
  "verification_point_of_contacts": [
    {
      "name": "Salbiah Abu",
      "department": "Graduate Verification Team",
      "email": "verify@staffemail.apu.edu.my",
      "title": "Programme Administrator",
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: Student Registration Number or Certificate. CLARIFICATIONS (Confirmed 14 Aug 2024): 1) Completion date = Award Date, 2) Status 'Completed' = qualification AWARDED."
    }
  ]
}
```

**Key Features**:
- ‚úÖ Person name from POC DETAILS
- ‚úÖ Title extracted: "Programme Administrator"
- ‚úÖ Department inferred from CONTACT DETAILS ("Graduate Verification Team")
- ‚úÖ Date-specific clarifications preserved (14 Aug 2024)
- ‚úÖ Verification process clarifications documented

---

### Example 10: Historical Records Limitations (Pattern A)

**CSV Input** (Row 81):
```
INSTITUTION NAME: Ateneo De Manila University Graduate School of Business
COUNTRY: Philippines
POC DETAILS: Registrar.gsb@ateneo.edu
CONTACT DETAILS: Office of the University Registrar
REQUIREMENTS: 1. LOA, 2. ECF
SPECIAL INSTRUCTION: Records cover from 1991 to the current date, but it should be noted that some records prior to 1996 may not be displayed. Please also note that names are displayed as recorded in our database and these may have changed since being recorded by the University.

To enquire about a person who has a formal qualification from the University, but whose name is not listed, please contact Records Registry by email registry_records@aut.ac.nz
```

**Perfect Output** (extensive limitations notes):
```json
{
  "institution_name": "Ateneo De Manila University Graduate School of Business",
  "country": "Philippines",
  "verification_point_of_contacts": [
    {
      "name": null,
      "department": "Office of the University Registrar",
      "email": "Registrar.gsb@ateneo.edu",
      "title": null,
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. RECORDS COVERAGE: 1991-present (records prior to 1996 may not be displayed). Names displayed as recorded in database (may have changed). ALTERNATIVE CONTACT: For unlisted persons with formal qualifications, contact Records Registry: registry_records@aut.ac.nz"
    }
  ]
}
```

**Key Features**:
- ‚úÖ Department-focused contact (no person name)
- ‚úÖ Historical records limitations documented (1991-present, pre-1996 issues)
- ‚úÖ Data quality notes (names may have changed)
- ‚úÖ Alternative contact provided for edge cases
- ‚úÖ Comprehensive notes for customer awareness

---

### Example 11: Temporal Online Portal Changes (Pattern A)

**CSV Input** (Row 84):
```
INSTITUTION NAME: ATHE Ltd (Awards for Training And Higher Education)
COUNTRY: United Kingdom
MOI: Online / Email
POC DETAILS: Prior to 2024 - https://athestudenthub.co.uk/verify-your-athe-certificate/

2024 onwards - https://atheportal.co.uk/verify-your-certification/
CONTACT DETAILS: support@athe.co.uk

Mollie, Quality and Assessment Team
REQUIREMENTS: 1. LOA, 2. ECF, 3. Certificate
```

**Perfect Output** (temporal portal changes):
```json
{
  "institution_name": "ATHE Ltd (Awards for Training And Higher Education)",
  "country": "United Kingdom",
  "verification_point_of_contacts": [
    {
      "name": "Mollie",
      "department": "Quality and Assessment Team",
      "email": "support@athe.co.uk",
      "title": null,
      "moi_methods": ["online", "email"],
      "online_verification_url": "https://atheportal.co.uk/verify-your-certification/",
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF, Certificate. ONLINE VERIFICATION: 2024 onwards use https://atheportal.co.uk/verify-your-certification/ (Prior to 2024: https://athestudenthub.co.uk/verify-your-athe-certificate/)"
    }
  ]
}
```

**Key Features**:
- ‚úÖ Hybrid MOI: ["online", "email"] (online first per CSV)
- ‚úÖ online_verification_url with current portal (2024 onwards)
- ‚úÖ Temporal change documented in notes (pre-2024 vs 2024+)
- ‚úÖ Person name: "Mollie" (first name only - as provided)
- ‚úÖ Department: "Quality and Assessment Team"

---

### Example 12: Vendor Field Visit with Payment (Pattern A)

**CSV Input** (Row 720):
```
INSTITUTION NAME: Loyola Institute of Business Administration
COUNTRY: India
MOI: Vendor
POC DETAILS: Vendor - via Field Visit (With Payment via Demand Draft)
CONTACT DETAILS: Mr. P. Sudhakar <sudhakar@liba.edu>
P. Sudhakar
Dean's Office
Loyola Institute of Business Administration (LIBA)
Loyola College Campus, Chennai - 600034
Phone : +91 9543277458 / 044 - 28177125
Web : www.liba.edu  Email: sudhakar@liba.edu
REQUIREMENTS: 1. LOA, 2. ECF
```

**Perfect Output** (vendor with full contact details):
```json
{
  "institution_name": "Loyola Institute of Business Administration",
  "country": "India",
  "verification_point_of_contacts": [
    {
      "name": "P. Sudhakar",
      "department": "Dean's Office",
      "email": "sudhakar@liba.edu",
      "phone": "+91 9543277458",
      "title": null,
      "moi_methods": ["vendor"],
      "is_primary": true,
      "routing_metadata": {
        "verification_status": "verified",
        "sources": ["RMI"],
        "citations": []
      },
      "notes": "Requirements: LOA, ECF. VENDOR METHOD: Field Visit required. PAYMENT: Via Demand Draft. ADDITIONAL PHONE: 044-28177125. ADDRESS: Loyola College Campus, Chennai - 600034. WEB: www.liba.edu"
    }
  ]
}
```

**Key Features**:
- ‚úÖ Vendor-only MOI method (field visit required)
- ‚úÖ Person: "P. Sudhakar" (extracted from "Mr. P. Sudhakar")
- ‚úÖ Department: "Dean's Office"
- ‚úÖ Payment method documented (Demand Draft)
- ‚úÖ Complete contact details: phone, address, web URL preserved in notes
- ‚úÖ Additional phone number documented (044-28177125)

---

## 4. Anti-Hallucination Checklist

**BEFORE submitting transformation, verify**:

- [ ] Used `--format json` for CSV reading (text format truncates at 100 chars)
- [ ] No forbidden placeholders: "Contact Person", "Main Campus", etc.
- [ ] All null fields are truly NULL (not invented values)
- [ ] verification_status = "verified" (RMI origin)
- [ ] sources = ["RMI"] (customer data)
- [ ] citations = [] (no web research for pure CSV)
- [ ] is_primary: First contact = true, rest = false
- [ ] notes: Combined REQUIREMENTS + SPECIAL INSTRUCTION
- [ ] Confidence score reflects uncertainty (0.60-0.70 for unclear data, 0.85-0.95 for clear)
- [ ] Applied 3-Question Framework for name/title/department

**Confidence Scoring Guidelines**:
- 0.95-1.0: Labeled fields (Pattern A), clear data, person name + title
- 0.85-0.95: Multi-campus clear structure (Pattern B)
- 0.70-0.85: Email-based inference, some ambiguity
- 0.60-0.70: High uncertainty, missing key fields
- 0.50-0.60: Minimal data, mostly null fields

---

## Quick Reference Summary

**üö® MANDATORY PLACEMENT REMINDER**: `routing_metadata` MUST appear INSIDE EACH contact object in the `verification_point_of_contacts` array. NEVER at university level.

**For CSV Transformation (RMI origin) - INSIDE EACH CONTACT**:
```json
{
  "verification_point_of_contacts": [
    {
      "name": "Contact Name",
      "email": "contact@university.edu",
      "department": "Department Name",
      "routing_metadata": {  // ‚Üê CRITICAL: INSIDE each contact object
        "verification_status": "verified",  // Always for RMI
        "sources": ["RMI"],                 // Always for CSV
        "citations": []                     // Always empty for pure CSV
      }
    }
  ]
}
```

**Decision Flow**:
1. Read CSV row with `--format json`
2. Detect pattern (A/B/C)
3. Extract contacts using 3-Question Framework
4. Apply NULL-First Principle
5. Set verification_status = "verified"
6. Score confidence honestly
7. Verify no hallucinations

**Remember**: If uncertain ‚Üí NULL. Missing data is better than wrong data.
